Smart contracts are self-executing programs on the blockchain with immutable code. Vulnerabilities in them can lead to significant economic losses. Symbolic execution, a powerful program analysis technique, is widely used for their security analysis. However, it faces path explosion, which limits Control Flow Graph (CFG) coverage. Existing methods use machine learning to enhance path exploration for symbolic execution. They lack adaptation to the characteristic of Ethereum Virtual Machine (EVM) bytecode, which is compiled from smart contract. Additionally, they ignore textual semantics of EVM bytecode. To deal with these, we propose SE4SC-LLM, a novel symbolic execution framework for smart contracts. It introduces 10-dimensional Symbolic Execution Feature (SEF) tailored for EVM runtime context. More importantly, it incorporates 3-dimensional Control Flow Embedding Feature (CFEF) derived from Large Language Model (LLM) embedding. For coverage-driven feature fusion, dynamic weight adjustment and residual optimization are utilized to generate general features. Based on these, an iterative training is used to enhance the path exploration capability of regression model. Against the baseline, SE4SC-LLM improves 4.9ï½ž19.5% in CFG coverage.
